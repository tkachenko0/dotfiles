#!/bin/bash

if [ -z "$VIA_DB_CONN" ]; then
    echo "Set VIA_DB_CONN first: export VIA_DB_CONN=connection_name"
    exit 1
fi

QUERY_FILE="$1"

if [ "$QUERY_FILE" = "-i" ]; then
    psql-connect "$VIA_DB_CONN"
elif [ -n "$QUERY_FILE" ]; then
    if [ ! -f "$QUERY_FILE" ]; then
        echo "Query file not found: $QUERY_FILE"
        exit 1
    fi
    psql-connect "$VIA_DB_CONN" "$QUERY_FILE"
else
    psql-connect "$VIA_DB_CONN"
fi